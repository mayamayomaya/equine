import{_ as F,a as Q,b as z}from"./QI28XbNY.js";import{u as L}from"./C95MDVUh.js";import{P as M,r as p,o as $,Y as A,I as v,C as c,g as u,y as _,B as r,x,N as G,L as s,D as y,z as K,A as h,R as P,S as Y,K as Z,Z as j}from"#entry";const q={key:1},H={class:"text-h6 mb-3 text-medium-emphasis"},te={__name:"index",setup(J){const o=L(),{searchQuery:T,globalSearchResults:l}=M(o),d=p(!1),k=p(""),g=p(null),f=p(""),I=p(null);$(()=>{o.loadFromStorage(),o.clearSearch()}),A(()=>{o.clearSearch()});const w=e=>{const t=l.value.find(a=>a.id===e.id);if(t){o.updateTaskInWorkspace(t.workspaceId,e.id,{text:e.text});const a=o.searchQuery;o.clearSearch(),j(()=>{o.setSearchQuery(a)})}},N=e=>{const t=l.value.find(a=>a.id===e);t&&o.deleteTaskFromWorkspace(t.workspaceId,e)},S=e=>{const t=l.value.find(a=>a.id===e);t&&o.toggleTaskCompleteInWorkspace(t.workspaceId,e)},U=e=>{k.value=e.task.imageUrl||"",g.value=e.task.id,f.value="task",d.value=!0},b=e=>{k.value=e.note.imageUrl||"",g.value=e.task.id,I.value=e.index,f.value="note",d.value=!0},C=e=>{const t=l.value.find(a=>a.id===e.taskId);if(t){if(e.type==="task")o.updateTaskInWorkspace(t.workspaceId,e.taskId,{imageUrl:e.url});else if(e.type==="note"){const i=o.workspaces.find(n=>n.id===t.workspaceId)?.tasks.find(n=>n.id===e.taskId);if(i&&i.notes){const n=[...i.notes];n[e.noteIndex]&&(n[e.noteIndex].imageUrl=e.url),o.updateTaskInWorkspace(t.workspaceId,e.taskId,{notes:n})}}d.value=!1}};return(e,t)=>{const a=F,i=u("v-card-text"),n=u("v-card"),V=u("v-chip"),D=Q,E=u("v-col"),W=u("v-row"),B=z,R=u("v-container");return _(),v(R,{class:"py-8"},{default:c(()=>[r(W,null,{default:c(()=>[r(E,{cols:"12",md:"8",class:"mx-auto"},{default:c(()=>[r(n,{class:"mb-4"},{default:c(()=>[r(i,null,{default:c(()=>[r(a,{placeholder:"Search all workspaces...",global:!0})]),_:1})]),_:1}),s(T)&&s(l).length===0?(_(),v(n,{key:0},{default:c(()=>[r(i,{class:"text-center py-8 text-medium-emphasis"},{default:c(()=>[...t[1]||(t[1]=[y(" No tasks found. Maybe you actually completed them? Good horse! ",-1)])]),_:1})]),_:1})):s(l).length>0?(_(),x("div",q,[K("div",H," Found "+h(s(l).length)+" result"+h(s(l).length!==1?"s":""),1),(_(!0),x(P,null,Y(s(l),m=>(_(),v(D,{key:m.id,task:m,onUpdate:w,onDelete:N,onToggleComplete:S,onEditImage:U,onEditNoteImage:b,class:"mb-3"},{prepend:c(()=>[r(V,{size:"small",variant:"tonal",class:"mb-2"},{default:c(()=>[y(h(m.workspaceName),1)]),_:2},1024)]),_:2},1032,["task"]))),128))])):G("",!0)]),_:1})]),_:1}),r(B,{modelValue:s(d),"onUpdate:modelValue":t[0]||(t[0]=m=>Z(d)?d.value=m:null),"image-url":s(k),"task-id":s(g),type:s(f),"note-index":s(I),onUpdate:C},null,8,["modelValue","image-url","task-id","type","note-index"])]),_:1})}}};export{te as default};
