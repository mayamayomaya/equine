import{_ as oe,k as C,g as r,I as g,y as u,C as t,z as c,B as a,X as H,L as x,N as h,T as le,x as M,A as k,D as d,r as B,R as K,S as P,K as se,P as me,o as ve,$ as fe,q as ke}from"#entry";import{u as ge}from"./C95MDVUh.js";const pe={class:"d-flex align-start"},ye={class:"flex-grow-1"},xe={class:"d-flex align-center mt-2 gap-1"},De={key:0,class:"text-caption text-grey mt-1"},we={__name:"MiniTaskCard",props:{task:{type:Object,required:!0},draggable:{type:Boolean,default:!0},showWorkspace:{type:Boolean,default:!1}},emits:["click","complete","dragstart"],setup(s,{emit:I}){const v=s,O=C(()=>v.task.completed?"flat":($.value,"elevated")),$=C(()=>{if(!v.task.due||v.task.completed)return!1;const D=new Date().toISOString().split("T")[0];return v.task.due<D}),S=C(()=>v.task.completed?"priority-done":$.value?"priority-overdue":v.task.notes?.length>2?"priority-high":"priority-normal"),b=C(()=>{const D=["purple","indigo","teal","orange","pink"],m=v.task.workspaceName?.charCodeAt(0)%D.length;return D[m]||"grey"}),V=D=>{const m=new Date(D),e=Math.floor((new Date-m)/(1e3*60*60*24));return e===0?"today":e===1?"yesterday":e<7?`${e} days ago`:m.toLocaleDateString("en",{month:"short",day:"numeric"})};return(D,m)=>{const w=r("v-checkbox"),e=r("v-chip"),z=r("v-icon"),f=r("v-card-text"),_=r("v-card");return u(),g(_,{variant:x(O),draggable:s.draggable&&!s.task.completed,onDragstart:m[2]||(m[2]=T=>D.$emit("dragstart",T)),onClick:m[3]||(m[3]=T=>D.$emit("click")),class:H(["mini-task-card",{"completed-task":s.task.completed,"overdue-task":x($)&&!s.task.completed}]),elevation:"3",hover:""},{default:t(()=>[c("div",{class:H(["task-priority-bar",x(S)])},null,2),a(f,{class:"pa-3"},{default:t(()=>[c("div",pe,[a(w,{"model-value":s.task.completed,"onUpdate:modelValue":m[0]||(m[0]=T=>D.$emit("complete")),onClick:m[1]||(m[1]=le(()=>{},["stop"])),density:"compact","hide-details":"",color:x($)?"error":"primary",class:"ma-0 pa-0 me-2 flex-grow-0"},null,8,["model-value","color"]),c("div",ye,[c("div",{class:H(["task-title font-weight-medium",{"text-decoration-line-through text-grey":s.task.completed,"text-error":x($)&&!s.task.completed}])},k(s.task.text),3),c("div",xe,[s.task.workspaceName&&s.showWorkspace?(u(),g(e,{key:0,size:"x-small",color:x(b),variant:"tonal",class:"font-weight-bold"},{default:t(()=>[d(k(s.task.workspaceName),1)]),_:1},8,["color"])):h("",!0),s.task.notes?.length>0?(u(),g(e,{key:1,size:"x-small",variant:"tonal",color:"blue"},{default:t(()=>[a(z,{start:"",size:"x-small"},{default:t(()=>[...m[4]||(m[4]=[d("mdi-note",-1)])]),_:1}),d(" "+k(s.task.notes.length),1)]),_:1})):h("",!0),s.task.imageUrl?(u(),g(e,{key:2,size:"x-small",variant:"tonal",color:"green"},{default:t(()=>[a(z,{size:"x-small"},{default:t(()=>[...m[5]||(m[5]=[d("mdi-image",-1)])]),_:1})]),_:1})):h("",!0)]),!s.task.completed&&s.task.created?(u(),M("div",De," Added "+k(V(s.task.created)),1)):h("",!0)]),s.draggable&&!s.task.completed?(u(),g(z,{key:0,size:"small",color:"grey-lighten-1",class:"drag-handle"},{default:t(()=>[...m[6]||(m[6]=[d(" mdi-drag-vertical ",-1)])]),_:1})):h("",!0)])]),_:1})]),_:1},8,["variant","draggable","class"])}}},_e=oe(we,[["__scopeId","data-v-6f594e2b"]]),he={class:"d-flex align-start"},$e={class:"flex-grow-1"},be={class:"text-h5 font-weight-bold white--text mb-2"},Te={class:"d-flex gap-2 flex-wrap"},Ce={class:"info-section mb-4"},Se={class:"d-flex align-center mb-2"},ze={key:0,class:"info-section mb-4"},Ie={class:"d-flex align-center mb-2"},Ee={class:"text-subtitle-2 font-weight-medium"},Ne={class:"text-body-2"},Oe={key:1,class:"info-section mb-4"},Ve={class:"d-flex align-center mb-2"},Me={__name:"TaskDetailDialog",props:{task:{type:Object,required:!0}},emits:["close","toggle-complete","edit","delete","view-image"],setup(s,{emit:I}){const v=s,O=I,$=B(!1),S=C(()=>v.task.completed?"header-completed":b.value?"header-overdue":"header-active"),b=C(()=>{if(!v.task.due||v.task.completed)return!1;const w=new Date().toISOString().split("T")[0];return v.task.due<w}),V=C(()=>{if(b.value)return"Overdue";if(!v.task.due)return"No deadline";const w=new Date().toISOString().split("T")[0];if(v.task.due===w)return"Due today";const e=new Date;return e.setDate(e.getDate()+1),v.task.due===e.toISOString().split("T")[0]?"Due tomorrow":"Upcoming"}),D=(w,e=!1)=>{if(!w)return"N/A";const z=new Date(w),f=new Date,_=Math.floor((f-z)/(1e3*60*60*24));if(e){if(_===0)return"today";if(_===1)return"yesterday";if(_===-1)return"tomorrow";if(_>0&&_<7)return`${_} days ago`;if(_<0&&_>-7)return`in ${Math.abs(_)} days`}return z.toLocaleDateString("en",{weekday:"short",month:"short",day:"numeric",year:z.getFullYear()!==f.getFullYear()?"numeric":void 0})},m=()=>{O("delete",v.task.id),$.value=!1};return(w,e)=>{const z=r("v-checkbox"),f=r("v-icon"),_=r("v-chip"),T=r("v-btn"),L=r("v-list-item-title"),W=r("v-list-item"),X=r("v-list"),R=r("v-img"),A=r("v-card-text"),F=r("v-card"),J=r("v-alert"),Q=r("v-divider"),Y=r("v-spacer"),j=r("v-card-actions"),Z=r("v-card-title"),ee=r("v-dialog");return u(),g(F,null,{default:t(()=>[c("div",{class:H(["task-header pa-4",x(S)])},[c("div",he,[a(z,{"model-value":s.task.completed,"onUpdate:modelValue":e[0]||(e[0]=l=>w.$emit("toggle-complete",s.task.id)),color:"white","hide-details":"",class:"mt-0 mr-3"},null,8,["model-value"]),c("div",$e,[c("h2",be,k(s.task.text),1),c("div",Te,[a(_,{size:"small",color:s.task.completed?"success":"white",variant:s.task.completed?"flat":"outlined"},{default:t(()=>[a(f,{start:"",size:"small"},{default:t(()=>[d(k(s.task.completed?"mdi-check-circle":"mdi-clock-outline"),1)]),_:1}),d(" "+k(s.task.completed?"Completed":x(V)),1)]),_:1},8,["color","variant"]),s.task.workspaceName?(u(),g(_,{key:0,size:"small",color:"white",variant:"outlined"},{default:t(()=>[a(f,{start:"",size:"small"},{default:t(()=>[...e[9]||(e[9]=[d("mdi-folder",-1)])]),_:1}),d(" "+k(s.task.workspaceName),1)]),_:1})):h("",!0)])]),a(T,{icon:"mdi-close",variant:"text",color:"white",onClick:e[1]||(e[1]=l=>w.$emit("close"))})])],2),a(A,{class:"pa-4"},{default:t(()=>[c("div",Ce,[c("div",Se,[a(f,{size:"small",class:"mr-2"},{default:t(()=>[...e[10]||(e[10]=[d("mdi-calendar",-1)])]),_:1}),e[11]||(e[11]=c("span",{class:"text-subtitle-2 font-weight-medium"},"Timeline",-1))]),a(X,{density:"compact",class:"pa-0"},{default:t(()=>[a(W,{class:"px-2"},{prepend:t(()=>[a(f,{size:"small",color:"grey"},{default:t(()=>[...e[12]||(e[12]=[d("mdi-plus",-1)])]),_:1})]),default:t(()=>[a(L,{class:"text-body-2"},{default:t(()=>[d(" Created "+k(D(s.task.created,!0)),1)]),_:1})]),_:1}),s.task.due?(u(),g(W,{key:0,class:"px-2"},{prepend:t(()=>[a(f,{size:"small",color:x(b)?"error":"primary"},{default:t(()=>[...e[13]||(e[13]=[d(" mdi-target ",-1)])]),_:1},8,["color"])]),default:t(()=>[a(L,{class:"text-body-2"},{default:t(()=>[d(" Due "+k(D(s.task.due,!0))+" ",1),x(b)&&!s.task.completed?(u(),g(_,{key:0,size:"x-small",color:"error",class:"ml-2"},{default:t(()=>[...e[14]||(e[14]=[d(" OVERDUE ",-1)])]),_:1})):h("",!0)]),_:1})]),_:1})):h("",!0),s.task.completed?(u(),g(W,{key:1,class:"px-2"},{prepend:t(()=>[a(f,{size:"small",color:"success"},{default:t(()=>[...e[15]||(e[15]=[d("mdi-check-circle",-1)])]),_:1})]),default:t(()=>[a(L,{class:"text-body-2"},{default:t(()=>[d(" Completed "+k(D(s.task.completedAt,!0)),1)]),_:1})]),_:1})):h("",!0)]),_:1})]),s.task.notes?.length>0?(u(),M("div",ze,[c("div",Ie,[a(f,{size:"small",class:"mr-2"},{default:t(()=>[...e[16]||(e[16]=[d("mdi-note-text",-1)])]),_:1}),c("span",Ee," Notes ("+k(s.task.notes.length)+") ",1)]),(u(!0),M(K,null,P(s.task.notes,(l,o)=>(u(),g(F,{key:o,variant:"outlined",class:"mb-2"},{default:t(()=>[a(A,{class:"pa-3"},{default:t(()=>[c("div",Ne,k(l.text),1),l.imageUrl?(u(),g(R,{key:0,src:l.imageUrl,class:"mt-2 rounded","max-height":"200",cover:"",onClick:i=>w.$emit("view-image",l.imageUrl)},null,8,["src","onClick"])):h("",!0)]),_:2},1024)]),_:2},1024))),128))])):h("",!0),s.task.imageUrl?(u(),M("div",Oe,[c("div",Ve,[a(f,{size:"small",class:"mr-2"},{default:t(()=>[...e[17]||(e[17]=[d("mdi-image",-1)])]),_:1}),e[18]||(e[18]=c("span",{class:"text-subtitle-2 font-weight-medium"},"Attachment",-1))]),a(R,{src:s.task.imageUrl,class:"rounded elevation-2","max-height":"300",cover:"",onClick:e[2]||(e[2]=l=>w.$emit("view-image",s.task.imageUrl)),style:{cursor:"pointer"}},null,8,["src"])])):h("",!0),s.task.rescheduleCount?(u(),g(J,{key:2,type:"info",variant:"tonal",density:"compact",class:"mb-3"},{default:t(()=>[a(f,{size:"small"},{default:t(()=>[...e[19]||(e[19]=[d("mdi-history",-1)])]),_:1}),d(" Rescheduled "+k(s.task.rescheduleCount)+" time"+k(s.task.rescheduleCount!==1?"s":""),1)]),_:1})):h("",!0)]),_:1}),a(Q),a(j,{class:"pa-4"},{default:t(()=>[s.task.completed?(u(),g(T,{key:1,variant:"tonal",onClick:e[4]||(e[4]=l=>w.$emit("toggle-complete",s.task.id))},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[22]||(e[22]=[d("mdi-undo",-1)])]),_:1}),e[23]||(e[23]=d(" Reopen ",-1))]),_:1})):(u(),g(T,{key:0,color:"success",variant:"flat",onClick:e[3]||(e[3]=l=>w.$emit("toggle-complete",s.task.id))},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[20]||(e[20]=[d("mdi-check",-1)])]),_:1}),e[21]||(e[21]=d(" Mark Complete ",-1))]),_:1})),a(T,{variant:"tonal",onClick:e[5]||(e[5]=l=>w.$emit("edit",s.task))},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[24]||(e[24]=[d("mdi-pencil",-1)])]),_:1}),e[25]||(e[25]=d(" Edit ",-1))]),_:1}),a(Y),a(T,{color:"error",variant:"text",onClick:e[6]||(e[6]=l=>$.value=!0)},{default:t(()=>[a(f,{start:""},{default:t(()=>[...e[26]||(e[26]=[d("mdi-delete",-1)])]),_:1}),e[27]||(e[27]=d(" Delete ",-1))]),_:1})]),_:1}),a(ee,{modelValue:x($),"onUpdate:modelValue":e[8]||(e[8]=l=>se($)?$.value=l:null),"max-width":"400"},{default:t(()=>[a(F,null,{default:t(()=>[a(Z,null,{default:t(()=>[...e[28]||(e[28]=[d("Delete Task?",-1)])]),_:1}),a(A,null,{default:t(()=>[d(' This action cannot be undone. The task "'+k(s.task.text)+'" will be permanently deleted. ',1)]),_:1}),a(j,null,{default:t(()=>[a(Y),a(T,{variant:"text",onClick:e[7]||(e[7]=l=>$.value=!1)},{default:t(()=>[...e[29]||(e[29]=[d("Cancel",-1)])]),_:1}),a(T,{color:"error",variant:"flat",onClick:m},{default:t(()=>[...e[30]||(e[30]=[d(" Delete ",-1)])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}},Ue=oe(Me,[["__scopeId","data-v-a880b906"]]),We={class:"text-center"},Ae={class:"text-h5"},Be={class:"text-caption text-medium-emphasis"},Le={class:"text-subtitle-2 font-weight-bold mb-3"},Re={class:"task-container"},Fe={class:"text-subtitle-1 font-weight-bold"},qe={class:"text-caption text-medium-emphasis"},He={key:0,class:"empty-day text-center py-8"},Ye={class:"text-caption text-grey mt-2"},je={__name:"index",setup(s){const I=ge(),{workspaces:v,currentWorkspaceId:O}=me(I),$=B(W(new Date)),S=B(!1),b=B(null),V=B(null),D=B(0),m=C(()=>{const l=[],o=new Date;o.setHours(0,0,0,0);for(let i=0;i<7;i++){const n=new Date($.value);n.setDate(n.getDate()+i+D.value);const p=n.getFullYear(),N=String(n.getMonth()+1).padStart(2,"0"),U=String(n.getDate()).padStart(2,"0"),q=`${p}-${N}-${U}`,G=X(q);l.push({date:q,dayName:n.toLocaleDateString("en",{weekday:"short"}),dateText:n.toLocaleDateString("en",{month:"short",day:"numeric"}),isToday:n.getTime()===o.getTime(),isWeekend:n.getDay()===0||n.getDay()===6,tasks:G})}return l});function w(){D.value-=1}function e(){D.value+=1}function z(){$.value=W(new Date),D.value=0}const f=C(()=>{const l=new Date;l.setHours(0,0,0,0);const o=l.toISOString().split("T")[0],i=[];return v.value.forEach(n=>{(!O.value||n.id===O.value)&&n.tasks?.forEach(p=>{p.due&&p.due<o&&!p.completed&&i.push({...p,workspaceId:n.id,workspaceName:n.name})})}),i}),_=C(()=>{const l=new Date($.value);l.setDate(l.getDate()+D.value);const o=new Date(l);o.setDate(o.getDate()+6);const i=l.toLocaleDateString("en",{month:"short"}),n=l.getDate(),p=o.getDate(),N=l.getFullYear();if(l.getMonth()===o.getMonth())return`${i} ${n} - ${p}, ${N}`;{const U=o.toLocaleDateString("en",{month:"short"});return`${i} ${n} - ${U} ${p}, ${N}`}}),T=C(()=>{const l=m.value.reduce((i,n)=>i+n.tasks.length,0),o=m.value.reduce((i,n)=>i+n.tasks.filter(p=>p.completed).length,0);return`${l} tasks${o>0?` (${o} completed)`:""}`}),L=C(()=>D.value===0);function W(l){const o=new Date(l),i=o.getDay(),n=o.getDate()-i;return o.setDate(n),o.setHours(0,0,0,0),o}function X(l){const o=[];return v.value.forEach(i=>{(!O.value||i.id===O.value)&&i.tasks?.forEach(n=>{n.due&&(n.due.includes("T")?n.due.split("T")[0]:n.due)===l&&o.push({...n,workspaceId:i.id,workspaceName:i.name})})}),o.sort((i,n)=>i.completed!==n.completed?i.completed?1:-1:new Date(n.created)-new Date(i.created))}function R(l){b.value=l,S.value=!0}function A(l){v.value.forEach(o=>{const i=o.tasks?.find(n=>n.id===l);i&&(i.completed=!i.completed,i.completedAt=i.completed?new Date().toISOString():null)}),I.saveToStorage()}function F(l,o){V.value=o,l.dataTransfer.effectAllowed="move",l.target.style.opacity="0.5"}function J(l,o){if(l.preventDefault(),!V.value)return;v.value.forEach(n=>{const p=n.tasks?.findIndex(N=>N.id===V.value.id);p!==-1&&(n.tasks[p].due=o,I.saveToStorage())});const i=document.querySelector('[style*="opacity: 0.5"]');i&&(i.style.opacity=""),V.value=null}function Q(){const l=new Date().toISOString().split("T")[0];f.value.forEach(o=>{const i=v.value.find(n=>n.id===o.workspaceId);if(i){const n=i.tasks.findIndex(p=>p.id===o.id);n!==-1&&(i.tasks[n].due=l)}}),I.saveToStorage()}ve(()=>{I.loadFromStorage()});function Y(l){let o=!1;v.value.forEach(i=>{const n=i.tasks?.find(p=>p.id===l);n&&(n.completed=!n.completed,n.completedAt=n.completed?new Date().toISOString():null,o=!0)}),o&&(I.saveToStorage(),b.value&&b.value.id===l&&(b.value.completed=!b.value.completed,b.value.completedAt=b.value.completed?new Date().toISOString():null))}function j(l){ke(`/task?workspace=${l.workspaceId}`),S.value=!1}function Z(l){v.value.forEach(o=>{const i=o.tasks?.findIndex(n=>n.id===l);i!==-1&&(o.tasks.splice(i,1),I.saveToStorage())}),S.value=!1}function ee(l){window.open(l,"_blank")}return(l,o)=>{const i=r("v-icon"),n=r("v-btn"),p=r("v-spacer"),N=r("v-card-title"),U=r("v-card"),q=r("v-chip"),G=_e,te=r("v-col"),ie=r("v-divider"),de=r("v-card-text"),ne=r("v-row"),re=Ue,ue=r("v-dialog"),ce=r("v-container");return u(),g(ce,{class:"py-8"},{default:t(()=>[a(ne,null,{default:t(()=>[a(te,{cols:"12"},{default:t(()=>[a(U,{class:"mb-4"},{default:t(()=>[a(N,{class:"d-flex align-center"},{default:t(()=>[a(n,{icon:"",onClick:w},{default:t(()=>[a(i,null,{default:t(()=>[...o[3]||(o[3]=[d("mdi-chevron-left",-1)])]),_:1})]),_:1}),a(p),c("div",We,[c("div",Ae,k(x(_)),1),c("div",Be,k(x(T)),1),x(L)?h("",!0):(u(),g(n,{key:0,variant:"text",size:"small",class:"mt-1",onClick:z},{default:t(()=>[...o[4]||(o[4]=[d(" Back to current week ",-1)])]),_:1}))]),a(p),a(n,{icon:"",onClick:e},{default:t(()=>[a(i,null,{default:t(()=>[...o[5]||(o[5]=[d("mdi-chevron-right",-1)])]),_:1})]),_:1})]),_:1})]),_:1}),a(ne,{dense:""},{default:t(()=>[x(f).length>0?(u(),g(te,{key:0,cols:"12",md:"auto"},{default:t(()=>[a(U,{class:"pa-3 h-100",color:"error",variant:"tonal","min-height":"400",width:"200"},{default:t(()=>[c("div",Le,[o[6]||(o[6]=d(" OVERDUE ",-1)),a(q,{size:"x-small",class:"ml-1"},{default:t(()=>[d(k(x(f).length),1)]),_:1})]),c("div",Re,[(u(!0),M(K,null,P(x(f),y=>(u(),g(G,{key:y.id,task:y,class:"mb-2",onClick:E=>R(y),onComplete:E=>A(y.id)},null,8,["task","onClick","onComplete"]))),128))]),a(n,{variant:"flat",size:"small",class:"mt-3 w-100",onClick:Q},{default:t(()=>[...o[7]||(o[7]=[d(" Move all to today ",-1)])]),_:1})]),_:1})]),_:1})):h("",!0),(u(!0),M(K,null,P(x(m),y=>(u(),g(te,{key:y.date,cols:"12",md:x(f).length>0?!0:""},{default:t(()=>[a(U,{class:H([{"today-column":y.isToday},"day-column h-100"]),variant:y.isToday?"elevated":"outlined",elevation:y.isToday?4:0,"min-height":"400"},{default:t(()=>[a(N,{class:"pb-2"},{default:t(()=>[c("div",null,[c("div",Fe,k(y.dayName),1),c("div",qe,k(y.dateText),1)]),a(p),y.tasks.length>0?(u(),g(q,{key:0,size:"small",variant:"tonal"},{default:t(()=>[d(k(y.tasks.length),1)]),_:2},1024)):h("",!0)]),_:2},1024),a(ie),a(de,{class:"task-drop-zone pa-2","data-date":y.date,onDragover:o[0]||(o[0]=le(()=>{},["prevent"])),onDrop:E=>J(E,y.date)},{default:t(()=>[y.tasks.length===0?(u(),M("div",He,[a(i,{size:"48",color:"grey-lighten-2"},{default:t(()=>[d(k(y.isWeekend?"mdi-horse":"mdi-calendar-blank"),1)]),_:2},1024),c("div",Ye,k(y.isWeekend?"Horse Weekend":"No tasks"),1)])):(u(),g(fe,{key:1,name:"task-list",tag:"div"},{default:t(()=>[(u(!0),M(K,null,P(y.tasks,E=>(u(),g(G,{key:E.id,task:E,draggable:!E.completed,class:"mb-2",onClick:ae=>R(E),onComplete:ae=>A(E.id),onDragstart:ae=>F(ae,E)},null,8,["task","draggable","onClick","onComplete","onDragstart"]))),128))]),_:2},1024))]),_:2},1032,["data-date","onDrop"])]),_:2},1032,["class","variant","elevation"])]),_:2},1032,["md"]))),128))]),_:1})]),_:1})]),_:1}),a(ue,{modelValue:x(S),"onUpdate:modelValue":o[2]||(o[2]=y=>se(S)?S.value=y:null),"max-width":"600"},{default:t(()=>[x(b)?(u(),g(re,{key:0,task:x(b),onClose:o[1]||(o[1]=y=>S.value=!1),onToggleComplete:Y,onEdit:j,onDelete:Z,onViewImage:ee},null,8,["task"])):h("",!0)]),_:1},8,["modelValue"])]),_:1})}}},Pe=oe(je,[["__scopeId","data-v-9a5da9b6"]]);export{Pe as default};
